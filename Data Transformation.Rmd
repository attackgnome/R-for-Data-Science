---
title: "Data Transformation"
author: "Joseph Romani"
date: "10/14/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r load_packages}
library(nycflights13)
library(tidyverse)
```


## 5.2.4 Exercise solutions

1. Find all flights that
  a. Had an arrival delay of two or more hours
  b. Flew to Houston (IAH or HOU)
  c. Were operated by United, American, or Delta
  d. Departed in summer (July, August, and September)
  e. Arrived more than two hours late, but didn’t leave late
  f. Were delayed by at least an hour, but made up over 30 minutes     in flight
  g.Departed between midnight and 6am (inclusive)
  
2. Another useful dplyr filtering helper is `between()`. What does it do? Can you use it to simplify the code needed to answer the previous challenges?
  
  *It for the syntax `between(x, limit1, limit2)` it filters on element x between limit1 and limit2 inclusively.
  
  ** see exercise 1.d and 1.g for examples this construct in use

```{r exercise_2.1a, echo=FALSE}
flights %>% 
  filter(arr_delay >=120)
```

```{r exercise_2.1b, echo=FALSE}
flights %>% 
  filter(dest == "IAH" | dest == "HOU")
```

```{r exercise_2.1c, echo=FALSE}
flights %>% 
  filter(carrier == "UA" | carrier == "AA"| carrier == "DL")
```


```{r exercise_2.1d, echo=FALSE}
flights %>% 
  filter(between(month, 7,9))
```

```{r exercise_2.1e, echo=FALSE}
flights %>% 
  filter(arr_delay > 120 & dep_delay <=0)
```

```{r exercise_2.1f, echo=FALSE}
flights %>% 
  filter(dep_delay >= 60 & (dep_delay - arr_delay) >30)
```


```{r exercise_2.1g}
flights %>% 
  filter(between(dep_time, 0, 600))
```


3. How many flights have a missing dep_time? What other variables are missing? What might these rows represent?

They may represent flights that never departed due to cancellations.

```{r exercise_2.3}
flights %>% 
  filter(is.na(dep_time))%>%
  summarize(n = n())
```
4. Why is `NA ^ 0` not missing? Why is `NA | TRUE` not missing? Why is `FALSE & NA` not missing? Can you figure out the general rule? (NA * 0 is a tricky counterexample!)

The general rule is that whenever there is a logical expressions, if one can be tested, then the result shouldn't be `NA`. And any operation that the results is determined, regardless of the number, the inputting `NA` does not affect the result.


## 5.3.1 Exercises


1. How could you use arrange() to sort all missing values to the start? (Hint: use is.na()).

```{r exercise_3.1}
flights %>% 
  arrange(!is.na(dep_time), dep_time)
```


2. Sort flights to find the most delayed flights. Find the flights that left earliest.

```{r exercise_3.2}
flights %>% 
  arrange(desc(dep_delay))

flights %>% 
  arrange(dep_time)
```


Sort flights to find the fastest (highest speed) flights.

```{r exercise_3.3}
flights %>% 
  mutate(speed = distance/air_time*60)%>%
  arrange(desc(speed))
```



Which flights travelled the farthest? Which travelled the shortest?

```{r exercise_3.3}
#farthest
flights %>% 
  arrange(desc(distance))

#shortest
flights %>% 
  arrange(distance)
```
## 5.4.1 Exercises

Brainstorm as many ways as possible to select dep_time, dep_delay, arr_time, and arr_delay from flights.

```{r exercise_4.1}
#select just the 4 columns
flights %>%
  select(dep_time, dep_delay, arr_time, arr_delay)

#select the columns that begin with a string
flights %>%
  select(starts_with("dep") | starts_with("arr"))

#select the columns that end with a string
flights %>%
  select((ends_with("time") | ends_with("delay")) & !(starts_with("sched") | starts_with("air")))

#reorder the 4 columns to the front
flights %>%
  select(dep_time, dep_delay, arr_time, arr_delay, everything())
```




What happens if you include the name of a variable multiple times in a select() call?

    It just returns the variable once

```{r exercise_4.2}
flights %>%
  select(arr_time, arr_time)
```


3. What does the any_of() function do? Why might it be helpful in conjunction with this vector?

    `any_of()` allows you to select all the variables named in a vector of character strings that are present in a dataframe
```{r exercise_4.3}
vars <- c("year", "month", "day", "dep_delay", "arr_delay")
flights %>%
  select(any_of(vars))
```

4. Does the result of running the following code surprise you? How do the select helpers deal with case by default? How can you change that default?

 *By default, each select_helper function ignore the cases of the variables.

```{r exercise_4.4}
select(flights, contains("TIME"))
```

## 5.5.2 Exercises

1. Currently dep_time and sched_dep_time are convenient to look at, but hard to compute with because they’re not really continuous numbers. Convert them to a more convenient representation of number of minutes since midnight.

```{r exercise_5.1}
flights %>%
  mutate(dep_time =  )

```

2. Compare air_time with arr_time - dep_time. What do you expect to see? What do you see? What do you need to do to fix it?

3. Compare dep_time, sched_dep_time, and dep_delay. How would you expect those three numbers to be related?

4. Find the 10 most delayed flights using a ranking function. How do you want to handle ties? Carefully read the documentation for min_rank().

5. What does 1:3 + 1:10 return? Why?

6. What trigonometric functions does R provide?



